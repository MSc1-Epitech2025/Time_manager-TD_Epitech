<div class="employee-dashboard">
  <main class="main-content">
    <div class="header">
      <h2>Dashboard - Employe</h2>
    </div>

    <header class="content-grid profile-zone">
      <div class="profile-card">
        <img src="assets/profile-placeholder.png" alt="Profil" class="profile-img" />
        <div class="profile-info">
          <h3>{{ user.name }}</h3>
          <p>{{ user.poste || 'Poste non renseigne' }}</p>
          <span class="email">{{ user.email }}</span>
        </div>
      </div>

      <div class="work-status">
        <p class="status-text">
          Temps travaille aujourd'hui :
          <span>{{ todayHoursMinutes.hours }}h {{ todayHoursMinutes.minutes }}m</span>
        </p>
        <p class="status-subtext" *ngIf="isWorking">Session en cours depuis {{ formattedTimer }}</p>
        <button
          class="btn btn-primary"
          (click)="toggleWorkStatus()"
          [disabled]="actionPending">
          <mat-icon>{{ isWorking ? 'pause_circle' : 'play_circle' }}</mat-icon>
          {{ statusLabel === 'Demarrer' ? 'Demarrer' : 'Mettre en pause' }}
        </button>
      </div>
    </header>

    <section class="content-grid metrics-zone">
      <div class="card large">
        <h3>Vue hebdomadaire</h3>
        <mat-card class="chart-card">
          <div class="chart-container" *ngIf="!loadingStats; else loading">
            <canvas
              baseChart
              [data]="pieChartData"
              [options]="chartOptions"
              chartType="pie"></canvas>
          </div>
          <ng-template #loading>
            <div class="loading">Chargement des statistiques...</div>
          </ng-template>
        </mat-card>
      </div>

      <div class="card small manager-card">
        <h3>Actions rapides</h3>
        <button mat-raised-button color="primary" (click)="goToPlanning()">
          <mat-icon>calendar_month</mat-icon>
          Consulter mon planning
        </button>
        <button mat-stroked-button color="accent" (click)="logout()">
          <mat-icon>logout</mat-icon>
          Deconnexion
        </button>
      </div>
    </section>
  </main>
</div>

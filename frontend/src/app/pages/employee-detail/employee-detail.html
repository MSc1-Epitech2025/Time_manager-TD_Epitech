<div class="employee-detail">
  <mat-card *ngIf="!loading && employeeData; else state">
    <h2>{{ employeeData.name }}</h2>
    <p>Team: {{ employeeData.team || 'Not set' }}</p>

    <div class="chart-container">
      <canvas
        baseChart
        [data]="pieChartData"
        [options]="chartOptions"
        chartType="pie">
      </canvas>
    </div>

    <button mat-raised-button color="accent" (click)="exportExcel()">
      <mat-icon>download</mat-icon>
      Download Excel Report
    </button>
  </mat-card>

  <ng-template #state>
    <mat-card class="placeholder">
      <ng-container *ngIf="loading; else noData">
        Loading statistics...
      </ng-container>
      <ng-template #noData>
        Unable to find information for this employee.
      </ng-template>
    </mat-card>
  </ng-template>
</div>


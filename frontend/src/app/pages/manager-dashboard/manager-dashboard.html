<div class="manager-dashboard">
  <main class="content">
    <div class="header">
      <h2>Manager Dashboard</h2>
    </div>

    <div class="main-grid">
      <mat-card class="team-card">
        <h3>My team</h3>

        <mat-form-field appearance="outline" class="search-field ">
          <mat-icon matPrefix>search</mat-icon>
          <input
            matInput
            placeholder="Search for an employee"
            [(ngModel)]="searchTerm"
            (input)="filterEmployees()" />
        </mat-form-field>

        <div class="empty-state" *ngIf="loadingEmployees">
          Loading...
        </div>

        <div class="empty-state" *ngIf="!loadingEmployees && !filteredEmployees.length">
          No collaborators to display.
        </div>

        <ul class="employee-list" *ngIf="filteredEmployees.length">
          <li
            *ngFor="let emp of filteredEmployees"
            (click)="selectEmployee(emp)"
            [class.selected]="selectedEmployee?.id === emp.id">
            <div class="name">{{ emp.name }}</div>
            <div class="team">{{ emp.team || 'Unknown team' }}</div>
          </li>
        </ul>
      </mat-card>

      <mat-card class="chart-card" *ngIf="selectedEmployee">
        <h3>{{ selectedEmployee.name }}</h3>
        <p>Team: {{ selectedEmployee.team || 'Not set' }}</p>

        <div class="chart-container">
          <canvas
            baseChart
            [data]="pieChartData"
            [options]="chartOptions"
            chartType="pie"></canvas>
        </div>

        <button mat-raised-button color="accent" class="export-btn" (click)="exportExcel()">
          <mat-icon>download</mat-icon>
          Export Excel
        </button>
      </mat-card>

      <mat-card class="chart-card placeholder" *ngIf="!loadingEmployees && !selectedEmployee">
        <p>Select an employee to display their indicators.</p>
      </mat-card>
    </div>
  </main>
</div>

